<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Verify Fix for Multiple Dates</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Verify Fix for Multiple Dates</h1>

    <div id="game-container">
        <canvas id="gameCanvas" width="500" height="500"></canvas>

        <div class="controls">
            <button id="newGameBtn">New Game</button>
            <button id="resetBtn">Reset</button>
            <input type="date" id="dateInput">
            <button id="loadDateBtn">Load Date</button>
        </div>

        <div class="info">
            <p id="dateDisplay"></p>
            <p id="scoreDisplay">Moves: 0</p>
            <p id="minMovesDisplay">Minimum Moves: 0</p>
            <p id="solvableStatus"></p>
        </div>
    </div>

    <div id="results" style="margin-top: 20px; padding: 10px; border: 1px solid #ccc; background-color: #f9f9f9;">
        <h3>Test Results</h3>
        <div id="resultsContent"></div>
    </div>

    <script src="constants.js"></script>
    <script src="utils.js"></script>
    <script src="seededRandom.js"></script>
    <script src="mapCreator.js"></script>
    <script src="player.js"></script>
    <script src="animation.js"></script>
    <script src="renderer.js"></script>
    <script src="inputHandler.js"></script>
    <script src="gameManager.js"></script>
    <script>
        // Initialize the game when the page loads
        window.onload = function() {
            const game = new GameManager();
            const resultsContent = document.getElementById('resultsContent');
            
            // Start the game loop
            game.startGameLoop();
            
            // Add a button to test multiple dates
            const testMultipleDatesBtn = document.createElement('button');
            testMultipleDatesBtn.textContent = 'Test Multiple Dates';
            testMultipleDatesBtn.style.marginTop = '20px';
            document.body.appendChild(testMultipleDatesBtn);
            
            testMultipleDatesBtn.addEventListener('click', function() {
                console.log("Testing multiple dates...");
                resultsContent.innerHTML = '<h4>Testing Multiple Dates</h4>';
                
                // Define a list of dates to test
                const datesToTest = [
                    "2025-04-30", // The date with the issue
                    "2023-01-01", // New Year's Day 2023
                    "2023-12-25", // Christmas 2023
                    "2024-02-29", // Leap Day 2024
                    "2024-07-04", // Independence Day 2024
                    "2025-01-01"  // New Year's Day 2025
                ];
                
                // Test each date
                datesToTest.forEach(dateStr => {
                    console.log(`Testing date: ${dateStr}`);
                    resultsContent.innerHTML += `<h4>Testing date: ${dateStr}</h4>`;
                    
                    // Generate map for this date
                    game.generateMapFromDate(dateStr);
                    
                    // Get the BFS result
                    const bfsResult = game.grid.checkSolvable(game.player.initialPos, true);
                    console.log("BFS result:", bfsResult);
                    resultsContent.innerHTML += `<p>BFS result: ${JSON.stringify(bfsResult)}</p>`;
                    
                    // Try to solve the puzzle with the minimum number of moves
                    let solved = false;
                    const directions = ['UP', 'RIGHT', 'DOWN', 'LEFT'];
                    let actualMoves = 0;
                    
                    // Try one move
                    for (let i = 0; i < 4; i++) {
                        // Reset the player
                        game.resetPlayer();
                        
                        // Make the move
                        game.movePlayer(i);
                        
                        // Check if the puzzle is solved
                        if (Utils.arePositionsEqual(game.player.pos, game.grid.targetPos)) {
                            console.log(`Puzzle solved in 1 move: ${directions[i]}`);
                            resultsContent.innerHTML += `<p>Puzzle solved in 1 move: ${directions[i]}</p>`;
                            solved = true;
                            actualMoves = 1;
                            break;
                        }
                    }
                    
                    if (!solved) {
                        // Try two moves
                        for (let i = 0; i < 4; i++) {
                            for (let j = 0; j < 4; j++) {
                                // Reset the player
                                game.resetPlayer();
                                
                                // Make the first move
                                game.movePlayer(i);
                                
                                // Make the second move
                                game.movePlayer(j);
                                
                                // Check if the puzzle is solved
                                if (Utils.arePositionsEqual(game.player.pos, game.grid.targetPos)) {
                                    console.log(`Puzzle solved in 2 moves: ${directions[i]} then ${directions[j]}`);
                                    resultsContent.innerHTML += `<p>Puzzle solved in 2 moves: ${directions[i]} then ${directions[j]}</p>`;
                                    solved = true;
                                    actualMoves = 2;
                                    break;
                                }
                            }
                            if (solved) break;
                        }
                    }
                    
                    if (!solved) {
                        // Try three moves
                        for (let i = 0; i < 4; i++) {
                            for (let j = 0; j < 4; j++) {
                                for (let k = 0; k < 4; k++) {
                                    // Reset the player
                                    game.resetPlayer();
                                    
                                    // Make the first move
                                    game.movePlayer(i);
                                    
                                    // Make the second move
                                    game.movePlayer(j);
                                    
                                    // Make the third move
                                    game.movePlayer(k);
                                    
                                    // Check if the puzzle is solved
                                    if (Utils.arePositionsEqual(game.player.pos, game.grid.targetPos)) {
                                        console.log(`Puzzle solved in 3 moves: ${directions[i]} then ${directions[j]} then ${directions[k]}`);
                                        resultsContent.innerHTML += `<p>Puzzle solved in 3 moves: ${directions[i]} then ${directions[j]} then ${directions[k]}</p>`;
                                        solved = true;
                                        actualMoves = 3;
                                        break;
                                    }
                                }
                                if (solved) break;
                            }
                            if (solved) break;
                        }
                    }
                    
                    if (!solved) {
                        // Try four moves
                        resultsContent.innerHTML += `<p>Could not solve the puzzle in 3 moves. Trying 4 moves would be too computationally intensive.</p>`;
                        resultsContent.innerHTML += `<p>BFS says minimum moves: ${bfsResult.minMoves}</p>`;
                    } else {
                        // Compare with BFS result
                        resultsContent.innerHTML += `<p>Actual moves: ${actualMoves}</p>`;
                        resultsContent.innerHTML += `<p>BFS says minimum moves: ${bfsResult.minMoves}</p>`;
                        
                        if (actualMoves === bfsResult.minMoves) {
                            resultsContent.innerHTML += `<p><strong>MATCH: Actual moves ${actualMoves} matches BFS minimum moves ${bfsResult.minMoves}.</strong></p>`;
                        } else {
                            resultsContent.innerHTML += `<p><strong>MISMATCH: Actual moves ${actualMoves} does not match BFS minimum moves ${bfsResult.minMoves}.</strong></p>`;
                        }
                    }
                    
                    resultsContent.innerHTML += `<hr>`;
                });
                
                resultsContent.innerHTML += `<p><strong>Testing complete.</strong></p>`;
            });
        };
    </script>
</body>
</html>